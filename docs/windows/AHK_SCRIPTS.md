### Markdown Documentation (`docs/AHK_SCRIPTS.md`)

# AutoHotkey Infrastructure for SL5-Aura-Service

Because Windows handles file locks and system hotkeys differently than Linux, this project uses a set of AutoHotkey (v2) scripts to bridge the gap between the Python STT engine and the Windows User Interface.

## Overview of Scripts

### 1. `trigger-hotkeys.ahk`
*   **Purpose:** The main user interface for controlling the service.
*   **Key Features:** 
    *   Intercepts **F10** and **F11** to start/stop dictation.
    *   Uses a `Keyboard Hook` to override default Windows system behavior (e.g., F10 activating the menu bar).
    *   **Deployment:** Designed to be registered via the Windows Task Scheduler with "Highest Privileges" so it can capture hotkeys even when the user is working in an Administrator-level application.

### 2. `type_watcher.ahk`
*   **Purpose:** Acts as the "Consumer" in the STT pipeline. 
*   **Key Features:**
    *   Watches a temporary directory for incoming `.txt` files generated by the Python engine.
    *   **State Machine (Zombie Map):** Implements a memory-based map to ensure each file is typed exactly once. This prevents "double-typing" caused by redundant Windows file-system events (Added/Modified).
    *   **Safe Typing:** Uses `SendText` to ensure special characters are handled correctly in any active editor.
    *   **Reliable Cleanup:** Manages file deletion with a retry-logic to handle Windows file-access locks.

### 3. `scripts/ahk/sync_editor.ahk`
*   **Purpose:** Ensures seamless synchronization between the disk and the text editor (e.g., Notepad++).
*   **Key Features:**
    *   **Save-on-Demand:** Can be triggered by Python to force a `Ctrl+S` in the editor before the engine reads the file.
    *   **Dialog Automator:** Automatically detects and confirms "File modified by another program" reload dialogs, creating a fluid real-time update experience.
    *   **Visual Feedback:** Provides short-lived notification boxes to inform the user that corrections are being applied.

### 4. `scripts/notification_watcher.ahk`
*   **Purpose:** Provides UI feedback for background processes.
*   **Key Features:**
    *   Monitors specific status files or events to display notifications to the user.
    *   Decouples the logic of "calculating" a message (Python) from "displaying" it (AHK), ensuring the main STT engine isn't blocked by UI interactions.

---

### Why this Documentation is important:
By documenting the **"Zombie Map"** and the **"Task Scheduler/Admin"** requirement, you explain to other developers (and your future self) why the code is more complex than a simple Linux script. It turns "weird workarounds" into "engineered solutions for Windows limitations."

(s,29.1.'26 11:02 Thu)
