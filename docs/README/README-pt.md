# Voz offline em todo o sistema para comandos ou texto, sistema conect√°vel

# SL5 Aura Service - Recursos e compatibilidade com IOS

Bem-vindo ao Servi√ßo SL5 Aura! Este documento fornece uma vis√£o geral r√°pida dos nossos principais recursos e da compatibilidade do sistema operacional.

Aura n√£o √© apenas uma transcritora; √© um poderoso mecanismo de processamento off-line que transforma sua voz em a√ß√µes e textos precisos.

√â um assistente offline completo baseado em Vosk e LanguageTool, projetado para personaliza√ß√£o definitiva por meio de um sistema de regras conect√°vel e um mecanismo de script din√¢mico.
  
  
Tradu√ß√µes: Este documento tamb√©m existe em [other languages](https://github.com/sl5net/SL5-aura-service/tree/master/docs).

Nota: Muitos textos s√£o tradu√ß√µes geradas automaticamente da documenta√ß√£o original em ingl√™s e destinam-se apenas a orienta√ß√£o geral. Em caso de discrep√¢ncias ou ambiguidades, prevalece sempre a vers√£o em ingl√™s. Agradecemos a ajuda da comunidade para melhorar esta tradu√ß√£o!


[![SL5 Aura (v0.7.0.2): A Deep Dive Under the Hood ‚Äì Live Coding & Core Concepts](https://img.youtube.com/vi/tEijy8WRFCI/maxresdefault.jpg)](https://www.youtube.com/watch?v=tEijy8WRFCI)
( https://skipvids.com/?v=tEijy8WRFCI )

## Principais recursos

* **Off-line e privado:** 100% local. Nenhum dado sai da sua m√°quina.
* **Mecanismo de script din√¢mico:** V√° al√©m da substitui√ß√£o de texto. As regras podem executar scripts Python personalizados (`on_match_exec`) para executar a√ß√µes avan√ßadas, como chamar APIs (por exemplo, pesquisar na Wikipedia), interagir com arquivos (por exemplo, gerenciar uma lista de tarefas) ou gerar conte√∫do din√¢mico (por exemplo, uma sauda√ß√£o por e-mail com reconhecimento de contexto).
* **Mecanismo de transforma√ß√£o de alto controle:** Implementa um pipeline de processamento altamente personaliz√°vel e orientado por configura√ß√£o. A prioridade das regras, a detec√ß√£o de comandos e as transforma√ß√µes de texto s√£o determinadas puramente pela ordem sequencial das regras nos Mapas Fuzzy, exigindo **configura√ß√£o, n√£o codifica√ß√£o**.
* **Uso conservador de RAM:** Gerencia a mem√≥ria de forma inteligente, pr√©-carregando modelos apenas se houver RAM livre suficiente dispon√≠vel, garantindo que outros aplicativos (como jogos de PC) sempre tenham prioridade.
* **Plataforma cruzada:** Funciona em Linux, macOS e Windows.
* **Totalmente Automatizado:** Gerencia seu pr√≥prio servidor LanguageTool (mas voc√™ tamb√©m pode usar um externo).
* **Extremamente r√°pido:** O cache inteligente garante notifica√ß√µes instant√¢neas de "escuta..." e processamento r√°pido.

## Documenta√ß√£o

Para uma refer√™ncia t√©cnica completa, incluindo todos os m√≥dulos e scripts, visite nossa p√°gina de documenta√ß√£o oficial. Ele √© gerado automaticamente e est√° sempre atualizado.

[**Go to Documentation >>**](https://sl5net.github.io/SL5-aura-service/)


### Status da compila√ß√£o
[![Linux Manjaro](https://img.shields.io/badge/Manjaro-Tested-27ae60?style=for-the-badge&logo=manjaro)](https://youtu.be/D9ylPBnP2aQ)
[![Linux Ubuntu](https://github.com/sl5net/SL5-aura-service/actions/workflows/ubuntu_setup.yml/badge.svg)](https://github.com/sl5net/SL5-aura-service/actions/workflows/ubuntu_setup.yml)
[![Linux Suse](https://github.com/sl5net/SL5-aura-service/actions/workflows/suse_setup.yml/badge.svg)](https://github.com/sl5net/SL5-aura-service/actions/workflows/suse_setup.yml)
[![macOS](https://github.com/sl5net/SL5-aura-service/actions/workflows/macos_setup.yml/badge.svg)](https://github.com/sl5net/SL5-aura-service/actions/workflows/macos_setup.yml)
[![Windows 11](https://github.com/sl5net/SL5-aura-service/actions/workflows/windows11_setup_bat.yml/badge.svg)](https://github.com/sl5net/SL5-aura-service/actions/workflows/windows11_setup_bat.yml)

[![Documentation](https://img.shields.io/badge/documentation-live-brightgreen)](https://sl5net.github.io/SL5-aura-service/)

---

## Instala√ß√£o

A configura√ß√£o √© um processo de duas etapas:
1. Clone este reposit√≥rio em seu computador.
2. Execute o script de configura√ß√£o √∫nico para seu sistema operacional.

Os scripts de configura√ß√£o cuidam de tudo: depend√™ncias do sistema, ambiente Python e download dos modelos e ferramentas necess√°rios (~ 4 GB) diretamente de nossas vers√µes do GitHub para velocidade m√°xima.

#### Para Linux e macOS e Windows
Abra um terminal no diret√≥rio raiz do projeto e execute o script para o seu sistema:
```bash
# For Ubuntu/Debian, Manjaro/Arch, macOs  or other derivatives

bash setup/{your-os}_setup.sh

# For Windows in Admin-Powershell

setup/windows11_setup.ps1
```

#### Para Windows
Execute o script de configura√ß√£o com privil√©gios de administrador **"Executar com PowerShell"**.

**Instale uma ferramenta para leitura e execu√ß√£o, por exemplo. [CopyQ](https://github.com/hluk/CopyQ) ou [AutoHotkey v2](https://www.autohotkey.com/)**. Isso √© necess√°rio para o observador de digita√ß√£o de texto.

---

## Uso

### 1. Inicie os servi√ßos

#### No Linux e macOS
Um √∫nico script cuida de tudo. Ele inicia o servi√ßo principal de ditado e o observador de arquivos automaticamente em segundo plano.
```bash
# Run this from the project's root directory
./scripts/restart_venv_and_run-server.sh
```

#### No Windows
Iniciar o servi√ßo √© um **processo manual de duas etapas**:

1. **Inicie o servi√ßo principal:** Execute `start_dictation_v2.0.bat`. ou inicie em `.venv` o servi√ßo com `python3`

### 2. Configure sua tecla de atalho

Para acionar o ditado, voc√™ precisa de uma tecla de atalho global que crie um arquivo espec√≠fico. Recomendamos enfaticamente a ferramenta multiplataforma [CopyQ](https://github.com/hluk/CopyQ).

#### Nossa recomenda√ß√£o: CopyQ

Crie um novo comando no CopyQ com um atalho global.

**Comando para Linux/macOS:**
```bash
touch /tmp/sl5_record.trigger
```

**Comando para Windows ao usar [CopyQ](https://github.com/hluk/CopyQ):**
__CODE_BLOCO_3__


**Comando para Windows ao usar [AutoHotkey](https://AutoHotkey.com):**
```js
copyq:
var filePath = 'c:/tmp/sl5_record.trigger';

var f = File(filePath);

if (f.openAppend()) {
    f.close();
} else {
    popup(
        'error',
        'cant read or open:\n' + filePath
        + '\n' + f.errorString()
    );
}
```


### 3. Comece a ditar!
Clique em qualquer campo de texto, pressione a tecla de atalho e uma notifica√ß√£o "Ouvindo..." aparecer√°. Fale claramente e depois fa√ßa uma pausa. O texto corrigido ser√° digitado para voc√™.

---


## Configura√ß√£o avan√ßada (opcional)

Voc√™ pode personalizar o comportamento do aplicativo criando um arquivo de configura√ß√µes locais.

1. Navegue at√© o diret√≥rio `config/`.
2. Crie uma c√≥pia de `settings_local.py_Example.txt` e renomeie-a para `settings_local.py`.
3. Edite `settings_local.py` para substituir qualquer configura√ß√£o do arquivo principal `config/settings.py`.

Este arquivo `settings_local.py` √© (talvez) ignorado pelo Git, ent√£o suas altera√ß√µes pessoais (talvez) n√£o ser√£o substitu√≠das por atualiza√ß√µes.

### Estrutura e l√≥gica do plug-in

A modularidade do sistema permite uma extens√£o robusta atrav√©s do diret√≥rio plugins/.

O mecanismo de processamento segue estritamente uma **Cadeia de Prioridade Hier√°rquica**:

1. **Ordem de carregamento do m√≥dulo (alta prioridade):** As regras carregadas dos pacotes de idiomas principais (de-DE, en-US) t√™m preced√™ncia sobre as regras carregadas do diret√≥rio plugins/ (que s√£o carregadas por √∫ltimo em ordem alfab√©tica).
  
2. **Ordem no arquivo (Micro Prioridade):** Dentro de qualquer arquivo de mapa (FUZZY_MAP_pre.py), as regras s√£o processadas estritamente por **n√∫mero de linha** (de cima para baixo).
  

Essa arquitetura garante que as regras b√°sicas do sistema sejam protegidas, enquanto regras espec√≠ficas do projeto ou sens√≠veis ao contexto (como aquelas para CodeIgniter ou controles de jogos) podem ser facilmente adicionadas como extens√µes de baixa prioridade por meio de plug-ins.
## Scripts principais para usu√°rios do Windows

Aqui est√° uma lista dos scripts mais importantes para configurar, atualizar e executar o aplicativo em um sistema Windows.

### Configura√ß√£o e atualiza√ß√£o
* `setup/setup.bat`: O script principal para a **configura√ß√£o inicial √∫nica** do ambiente.
* [or](https://github.com/sl5net/SL5-aura-service/actions/runs/16548962826/job/46800935182) `Executar powershell -Command "Set-ExecutionPolicy -ExecutionPolicy Bypass -Scope Process -Force; .\setup\windows11_setup.ps1"`

* `update.bat` : Execute-os na pasta do projeto **obtenha o c√≥digo e as depend√™ncias mais recentes**.

### Executando o aplicativo
* `start_dictation_v2.0.bat`: Um script prim√°rio para **iniciar o servi√ßo de ditado**.

### Scripts principais e auxiliares
* `dictation_service.py`: O servi√ßo principal do Python (geralmente iniciado por um dos scripts acima).
* `get_suggestions.py`: Um script auxiliar para funcionalidades espec√≠ficas.




## üöÄ Principais recursos e compatibilidade de sistema operacional

Legenda para compatibilidade de sistema operacional:  
* üêß **Linux** (por exemplo, Arch, Ubuntu)  
* üçè **macOS**  
* ü™ü **Windows**  
* üì± **Android** (para recursos espec√≠ficos para dispositivos m√≥veis)  

---

### **Motor principal de convers√£o de fala em texto (Aura)**
Nosso principal mecanismo para reconhecimento de fala offline e processamento de √°udio.

**Aura-Core/** üêß üçè ü™ü  
‚îú‚îÄ `dictation_service.py` (principal servi√ßo Python orquestrando Aura) üêß üçè ü™ü  
‚îú‚î¨ **Live Hot-Reload** (Configura√ß√£o e Mapas) üêß üçè ü™ü  
‚îÇ‚îú **Processamento e corre√ß√£o de texto/** Agrupado por idioma (por exemplo, `de-DE`, `en-US`, ...)   
‚îÇ‚îú 1. `normalize_punctuation.py` (padroniza a pontua√ß√£o p√≥s-transcri√ß√£o) üêß üçè ü™ü  
‚îÇ‚îú 2. **Pr√©-corre√ß√£o inteligente** (`FuzzyMap Pre` - **A camada de comando prim√°ria**) üêß üçè ü™ü  
‚îÇ‚îÇ * **Execu√ß√£o din√¢mica de script:** As regras podem acionar scripts Python personalizados (on_match_exec) para executar a√ß√µes avan√ßadas como chamadas de API, E/S de arquivo ou gerar respostas din√¢micas.  
‚îÇ‚îÇ * **Execu√ß√£o em Cascata:** As regras s√£o processadas sequencialmente e seus efeitos s√£o **cumulativos**. Regras posteriores se aplicam ao texto modificado por regras anteriores.  
‚îÇ‚îÇ * **Crit√©rio de parada de prioridade mais alta:** Se uma regra atingir uma **Correspond√™ncia completa** (^...$), todo o pipeline de processamento desse token ser√° interrompido imediatamente. Este mecanismo √© fundamental para implementar comandos de voz confi√°veis.  
‚îÇ‚îú 3. `correct_text_by_languagetool.py` (Integra o LanguageTool para corre√ß√£o de gram√°tica/estilo) üêß üçè ü™ü  
‚îÇ‚îî 4. **P√≥s-Corre√ß√£o Inteligente** (`FuzzyMap`)**‚Äì Refinamento P√≥s-LT** üêß üçè ü™ü  
‚îÇ‚îÇ * Aplicado ap√≥s o LanguageTool para corrigir sa√≠das espec√≠ficas do LT. Segue a mesma l√≥gica estrita de prioridade em cascata da camada de pr√©-corre√ß√£o.  
‚îÇ‚îÇ * **Execu√ß√£o din√¢mica de script:** As regras podem acionar scripts Python personalizados (on_match_exec) para executar a√ß√µes avan√ßadas como chamadas de API, E/S de arquivo ou gerar respostas din√¢micas.  
‚îÇ‚îÇ * **Fuzzy Fallback:** A **Verifica√ß√£o de similaridade difusa** (controlada por um limite, por exemplo, 85%) atua como a camada de corre√ß√£o de erros de prioridade mais baixa. Ele s√≥ ser√° executado se toda a execu√ß√£o anterior da regra determin√≠stica/em cascata n√£o conseguir encontrar uma correspond√™ncia (current_rule_matched √© False), otimizando o desempenho evitando verifica√ß√µes difusas lentas sempre que poss√≠vel.  
‚îú‚î¨ **Gerenciamento de modelo/**   
‚îÇ‚îú‚îÄ `prioritize_model.py` (otimiza o carregamento/descarregamento do modelo com base no uso) üêß üçè ü™ü  
‚îÇ‚îî‚îÄ `setup_initial_model.py` (configura a configura√ß√£o inicial do modelo) üêß üçè ü™ü  
‚îú‚îÄ **Tempo limite do VAD adapt√°vel** üêß üçè ü™ü  
‚îú‚îÄ **Tecla de atalho adaptativa (Iniciar/Parar)** üêß üçè ü™ü  
‚îî‚îÄ **Troca instant√¢nea de idioma** (Experimental via pr√©-carregamento de modelo) üêß üçè   

**Utilit√°rios do sistema/**   
‚îú‚î¨ **Gerenciamento de servidor LanguageTool/**   
‚îÇ‚îú‚îÄ `start_languagetool_server.py` (inicializa o servidor LanguageTool local) üêß üçè ü™ü  
‚îÇ‚îî‚îÄ `stop_languagetool_server.py` (Desliga o servidor LanguageTool) üêß üçè
‚îú‚îÄ `monitor_mic.sh` (por exemplo, para uso com fone de ouvido sem usar teclado e monitor) üêß üçè ü™ü  

### **Gerenciamento de modelos e pacotes**  
Ferramentas para manipula√ß√£o robusta de modelos de linguagem grandes.  

**Gerenciamento de modelo/** üêß üçè ü™ü  
‚îú‚îÄ **Downloader de modelo robusto** (peda√ßos de lan√ßamento do GitHub) üêß üçè ü™ü  
‚îú‚îÄ `split_and_hash.py` (Utilit√°rio para propriet√°rios de reposit√≥rios dividirem arquivos grandes e gerarem somas de verifica√ß√£o) üêß üçè ü™ü  
‚îî‚îÄ `download_all_packages.py` (ferramenta para usu√°rios finais baixarem, verificarem e remontarem arquivos de v√°rias partes) üêß üçè ü™ü  


### **Ajudantes de desenvolvimento e implanta√ß√£o**  
Scripts para configura√ß√£o de ambiente, teste e execu√ß√£o de servi√ßo.  

**DevHelpers/**  
‚îú‚î¨ **Gerenciamento de ambiente virtual/**  
‚îÇ‚îú `scripts/restart_venv_and_run-server.sh` (Linux/macOS) üêß üçè  
‚îÇ‚îî `scripts/restart_venv_and_run-server.ahk` (Windows) ü™ü  
‚îú‚î¨ **Integra√ß√£o de ditado em todo o sistema/**  
‚îÇ‚îú Integra√ß√£o Vosk-System-Listener üêß üçè ü™ü  
‚îÇ‚îú `scripts/monitor_mic.sh` (monitoramento de microfone espec√≠fico do Linux) üêß  
‚îÇ‚îî `scripts/type_watcher.ahk` (AutoHotkey escuta texto reconhecido e digita-o em todo o sistema) ü™ü  
‚îî‚îÄ **Automa√ß√£o CI/CD/**  
‚îî‚îÄ Fluxos de trabalho expandidos do GitHub (instala√ß√£o, teste, implanta√ß√£o de documentos) üêß üçè ü™ü *(Executado em a√ß√µes do GitHub)*  

### **Recursos futuros/experimentais**  
Recursos atualmente em desenvolvimento ou em status de rascunho.  

**Recursos Experimentais/**  
‚îú‚îÄ **ENTER_AFTER_DICTATION_REGEX** Exemplo de regra de ativa√ß√£o "(ExampleAplicationThatNotExist|Pi, sua IA pessoal)" üêß  
‚îú‚î¨Plugins  
‚îÇ‚ï∞‚î¨ **Live Lazy-Reload** (*) üêß üçè ü™ü  
(*Altera√ß√µes na ativa√ß√£o/desativa√ß√£o do plug-in e suas configura√ß√µes s√£o aplicadas na pr√≥xima execu√ß√£o de processamento sem reinicializa√ß√£o do servi√ßo.*)  
‚îÇ ‚îú **comandos git** (Controle de voz para enviar comandos git) üêß üçè ü™ü  
‚îÇ ‚îú **wannweil** (Mapa para localiza√ß√£o Alemanha-Wannweil) üêß üçè ü™ü  
‚îÇ ‚îú **Poker Plugin (Draft)** (Controle de voz para aplicativos de p√¥quer) üêß üçè ü™ü  
‚îÇ ‚îî **Plugin 0 A.D. (Draft)** (Controle de voz para jogo 0 A.D.) üêß   
‚îú‚îÄ **Sa√≠da de som ao iniciar ou encerrar uma sess√£o** (descri√ß√£o pendente) üêß   
‚îú‚îÄ **Sa√≠da de fala para deficientes visuais** (Descri√ß√£o pendente) üêß üçè ü™ü  
‚îî‚îÄ **Prot√≥tipo SL5 Aura Android** (Ainda n√£o totalmente offline) üì±  

---

*(Nota: Distribui√ß√µes espec√≠ficas do Linux como Arch (ARL) ou Ubuntu (UBT) s√£o cobertas pelo s√≠mbolo geral do Linux üêß. Distin√ß√µes detalhadas podem ser abordadas nos guias de instala√ß√£o.)*









<detalhes>
<summary>Clique para ver o comando usado para gerar esta lista de scripts</summary>

__CODE_BLOCO_5__
</detalhes>


### observe graficamente o que est√° por tr√°s:

![yappi_call_graph](doc_sources/DeveloperGuide_Generating_ServiceCallGraph/yappi_call_graph_stripped.svg_20251024_010459.png "doc_sources/DeveloperGuide_Generating_ServiceCallGraph/yappi_call_graph_stripped.svg_20251024_010459.png")

  
![pydeps -v -o dependencies.svg scripts/py/func/main.py](doc_sources/dependencies.svg)


# Modelos Usados:

Recomenda√ß√£o: use modelos do Mirror https://github.com/sl5net/SL5-aura-service/releases/tag/v0.2.0.1 (provavelmente mais r√°pido)

Estes modelos compactados devem ser salvos na pasta `models/`

`mv vosk-model-*.zip modelos/`


| Modelo | Tamanho | Taxa/velocidade de erros de palavras | Notas | Licen√ßa |
| -------------------------------------------------------------------------------------- | ---- | --------------------------------------------------------------------------------------------- | ----------------------------------------- | ---------- |
| [vosk-model-en-us-0.22](https://alphacephei.com/vosk/models/vosk-model-en-us-0.22.zip) | 1,8G | 5,69 (librisspeech test-clean)<br/>6,05 (tedlium)<br/>29,78 (callcenter) | Modelo gen√©rico preciso do ingl√™s dos EUA | Apache2.0 |
| [vosk-model-de-0.21](https://alphacephei.com/vosk/models/vosk-model-de-0.21.zip) | 1,9G | 9,83 (teste Tuda-de)<br/>24,00 (podcast)<br/>12,82 (teste cv)<br/>12,42 (mls)<br/>33,26 (mtedx) | Grande modelo alem√£o para telefonia e servidor | Apache2.0 |

Esta tabela fornece uma vis√£o geral dos diferentes modelos Vosk, incluindo tamanho, taxa ou velocidade de erro de palavras, notas e informa√ß√µes de licen√ßa.


**Modelos Vosk:** [Vosk-Model List](https://alphacephei.com/vosk/models)
- **Ferramenta de Idioma:**  
(6.6)[https://languagetool.org/download/](https://languagetool.org/download/)

**Licen√ßa do LanguageTool:** [GNU Lesser General Public License (LGPL) v2.1 or later](https://www.gnu.org/licenses/old-licenses/lgpl-2.1.html)

---

## Apoie o Projeto
Se voc√™ achar esta ferramenta √∫til, considere comprar um caf√© para n√≥s! Seu apoio ajuda a impulsionar melhorias futuras.

[![ko-fi](https://storage.ko-fi.com/cdn/useruploads/C0C445TF6/qrcode.png?v=5151393b-8fbb-4a04-82e2-67fcaea9d5d8?v=2)](https://ko-fi.com/C0C445TF6)

[Stripe-Buy Now](https://buy.stripe.com/3cIdRa1cobPR66P1LP5kk00)